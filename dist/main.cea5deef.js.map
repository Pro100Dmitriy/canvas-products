{"version":3,"sources":["assets/js/main.js"],"names":["document","addEventListener","event","$IMG","getElementById","getBoundingClientRect","WIDTH","width","HEIGHT","height","DPI_WIDTH","DPI_HEIGHT","chart","canvas","data","ctx","getContext","style","renderPoints","render","beginPath","lineWidth","strokeStyle","x","y","lineTo","stroke","closePath","render_from_LC","all_path","localStorage","getItem","JSON","parse","forEach","item","path","click","clientX","clientY","push","new_path","finish_path","save_path","new_path_func","finish_path_func","save_path_func","save_LC","removeEventListener","console","log","all_objects","product","id","color","points","devider","removeItem","rendPoints","map","minX","Math","min","maxX","max","points_array","point","index","intersection","line","k","b"],"mappings":"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","file":"main.cea5deef.js","sourceRoot":"..","sourcesContent":["document.addEventListener('DOMContentLoaded', event => {\r\n\r\n\r\nconst $IMG = document.getElementById('plugin-img').getBoundingClientRect()\r\nconst WIDTH = $IMG.width\r\nconst HEIGHT = $IMG.height\r\nconst DPI_WIDTH = WIDTH * 2\r\nconst DPI_HEIGHT = HEIGHT * 2\r\n\r\n\r\nfunction chart( canvas, data ){\r\n    const ctx = canvas.getContext('2d')\r\n    canvas.style.width = WIDTH + 'px'\r\n    canvas.style.height = HEIGHT + 'px'\r\n    canvas.width = DPI_WIDTH\r\n    canvas.height = DPI_HEIGHT\r\n\r\n    let renderPoints = []\r\n\r\n    function render(){\r\n        ctx.beginPath()\r\n        ctx.lineWidth = 4\r\n        ctx.strokeStyle = \"red\"\r\n        for(const [x, y] of renderPoints){\r\n            ctx.lineTo(x, y)\r\n        }\r\n        ctx.stroke()\r\n        ctx.closePath()\r\n\r\n        render_from_LC()\r\n    }\r\n\r\n    function render_from_LC(){\r\n        let all_path = []\r\n        if( localStorage.getItem('path') ){\r\n            all_path = JSON.parse( localStorage.getItem('path') ) \r\n        }\r\n\r\n        all_path.forEach( item => {\r\n            ctx.beginPath()\r\n            ctx.lineWidth = 4\r\n            ctx.strokeStyle = \"red\"\r\n            for(const [x, y] of item.path){\r\n                ctx.lineTo(x, y)\r\n            }\r\n            ctx.stroke()\r\n            ctx.closePath()\r\n        } )\r\n        \r\n    }\r\n\r\n    function click(event){\r\n        let x = event.clientX\r\n        let y = event.clientY\r\n\r\n        renderPoints.push([x * 2, y * 2])\r\n        \r\n        render()\r\n    }\r\n    canvas.addEventListener('click', click)\r\n\r\n\r\n    let new_path = document.getElementById('new-path')\r\n    let finish_path = document.getElementById('finish-path')\r\n    let save_path = document.getElementById('save-path')\r\n\r\n    new_path.addEventListener('click', new_path_func)\r\n    finish_path.addEventListener('click', finish_path_func)\r\n    save_path.addEventListener('click', save_path_func)\r\n\r\n    function new_path_func(event){\r\n        canvas.addEventListener('click', click)\r\n    }\r\n    function finish_path_func(event){\r\n        let x = renderPoints[0][0]\r\n        let y = renderPoints[0][1]\r\n\r\n        renderPoints.push([x, y])\r\n\r\n        render()\r\n        save_LC()\r\n        canvas.removeEventListener('click', click)\r\n        renderPoints = []\r\n    }\r\n    function save_path_func(event){\r\n        console.log('save')\r\n    }\r\n\r\n\r\n    function save_LC(){\r\n        let all_objects = []\r\n        if( localStorage.getItem('path') ){\r\n            all_objects = JSON.parse( localStorage.getItem('path') ) \r\n        }\r\n        \r\n        let product = {\r\n            id: '1',\r\n            color: 'red',\r\n            path: renderPoints,\r\n            points: devider(renderPoints)\r\n        }\r\n\r\n        all_objects.push( product )\r\n\r\n        localStorage.removeItem( 'path' )\r\n        //localStorage.setItem( 'path', JSON.stringify( all_objects ) )\r\n    }\r\n\r\n\r\n    function devider(rendPoints){\r\n        let x = rendPoints.map( item => item[0] )\r\n\r\n        let minX = Math.min( ...x )\r\n        let maxX = Math.max( ...x )\r\n\r\n        let points_array = []\r\n\r\n        for(let x = minX; x < maxX; x++){\r\n            renderPoints.forEach( (point, index) => {\r\n                console.log( intersection( x, [point, rendPoints[index+1]] ) )\r\n                // if( intersection( x, [point, rendPoints[index+1]] ) != [] ){\r\n                //     points_array.push( intersection( x, [point, rendPoints[index+1]] ) )\r\n                // }\r\n            } )\r\n        }\r\n\r\n        return null\r\n    }\r\n\r\n\r\n    function intersection( x, line ){\r\n        let k = ( line[1][1] - line[0][1] ) / ( line[1][0] - line[0][0] )\r\n        let b = line[0][1] - k * line[0][0]\r\n\r\n        if( x >= line[0][0] && x <= line[1][0] ){\r\n            return  [x, k*x+b]\r\n        }else{\r\n            return false\r\n        }\r\n    }\r\n\r\n\r\n    render()\r\n\r\n}\r\n\r\n\r\nchart( document.getElementById('plugin-canvas'), [] )\r\n\r\n\r\n} )"]}